<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VIB34D System Test Runner - 2025 Standards</title>
    <style>
        body {
            font-family: 'Courier New', monospace;
            background: #000;
            color: #0f0;
            margin: 0;
            padding: 20px;
            line-height: 1.4;
        }
        .header {
            text-align: center;
            border: 2px solid #0f0;
            padding: 20px;
            margin-bottom: 20px;
        }
        .test-section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #333;
            background: #111;
        }
        .pass { color: #0f0; }
        .fail { color: #f00; }
        .warn { color: #ff0; }
        .status-excellent { color: #0f0; font-weight: bold; }
        .status-good { color: #ff0; font-weight: bold; }
        .status-poor { color: #f00; font-weight: bold; }
        #testOutput {
            background: #000;
            border: 1px solid #333;
            padding: 15px;
            height: 400px;
            overflow-y: scroll;
            white-space: pre-wrap;
            font-size: 12px;
        }
        .controls {
            text-align: center;
            margin: 20px 0;
        }
        button {
            background: #222;
            color: #0f0;
            border: 1px solid #0f0;
            padding: 10px 20px;
            cursor: pointer;
            margin: 0 10px;
            font-family: inherit;
        }
        button:hover {
            background: #0f0;
            color: #000;
        }
        iframe {
            width: 100%;
            height: 600px;
            border: 1px solid #333;
            background: #fff;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ğŸš€ VIB34D SYSTEM VALIDATION</h1>
        <h2>2025 Web Standards Compliance Testing</h2>
        <p>Comprehensive automated testing framework</p>
    </div>

    <div class="controls">
        <button onclick="loadVIB34D()">ğŸ”„ Load VIB34D System</button>
        <button onclick="runTests()">ğŸ§ª Run Comprehensive Tests</button>
        <button onclick="runMobileTest()">ğŸ“± Mobile Test</button>
        <button onclick="clearOutput()">ğŸ§¹ Clear Output</button>
    </div>

    <div class="test-section">
        <h3>ğŸ“Š Test Output Console</h3>
        <div id="testOutput">Ready to test VIB34D system...\nClick "Load VIB34D System" to begin.\n</div>
    </div>

    <div class="test-section">
        <h3>ğŸ–¥ï¸ System Under Test</h3>
        <iframe id="testFrame" src="about:blank"></iframe>
    </div>

    <div class="test-section">
        <h3>ğŸ“ˆ Test Results Summary</h3>
        <div id="resultsSummary">
            <p>No tests run yet.</p>
        </div>
    </div>

    <script>
        const output = document.getElementById('testOutput');
        const frame = document.getElementById('testFrame');
        const results = document.getElementById('resultsSummary');

        function log(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const colorClass = type === 'pass' ? 'pass' : type === 'fail' ? 'fail' : type === 'warn' ? 'warn' : '';
            output.innerHTML += `<span class="${colorClass}">[${timestamp}] ${message}</span>\n`;
            output.scrollTop = output.scrollHeight;
        }

        function clearOutput() {
            output.innerHTML = '';
            log('Output cleared.');
        }

        function loadVIB34D() {
            log('ğŸ”„ Loading VIB34D system...', 'info');
            frame.src = 'index-clean.html';
            
            frame.onload = function() {
                log('âœ… VIB34D system loaded successfully', 'pass');
                log('ğŸ“‹ System ready for testing', 'info');
                
                // Inject test script into iframe
                setTimeout(() => {
                    try {
                        const testScript = frame.contentDocument.createElement('script');
                        testScript.src = 'manual-system-validation.js';
                        frame.contentDocument.head.appendChild(testScript);
                        log('ğŸ§ª Test framework injected', 'pass');
                    } catch (error) {
                        log('âš ï¸ Could not inject test framework: ' + error.message, 'warn');
                    }
                }, 1000);
            };
            
            frame.onerror = function() {
                log('âŒ Failed to load VIB34D system', 'fail');
            };
        }

        function runTests() {
            if (!frame.src || frame.src.includes('about:blank')) {
                log('âŒ VIB34D system not loaded. Click "Load VIB34D System" first.', 'fail');
                return;
            }

            log('ğŸš€ Starting comprehensive system tests...', 'info');
            log('ğŸ“‹ Testing 2025 web standards compliance', 'info');

            try {
                const frameWindow = frame.contentWindow;
                const frameDoc = frame.contentDocument;

                // Test 1: System Loading & Architecture
                log('\nğŸ“‹ Test 1: System Architecture', 'info');
                
                if (frameWindow.switchSystem) {
                    log('âœ… switchSystem() function: FOUND', 'pass');
                } else {
                    log('âŒ switchSystem() function: MISSING', 'fail');
                }

                if (frameWindow.updateParameter) {
                    log('âœ… updateParameter() function: FOUND', 'pass');
                } else {
                    log('âŒ updateParameter() function: MISSING', 'fail');
                }

                if (frameWindow.currentSystem) {
                    log(`âœ… Current system: ${frameWindow.currentSystem}`, 'pass');
                } else {
                    log('âš ï¸ Current system: NOT INITIALIZED', 'warn');
                }

                // Test 2: System Buttons
                log('\nğŸ“‹ Test 2: System Button Validation', 'info');
                const systems = ['faceted', 'quantum', 'holographic', 'polychora'];
                let foundButtons = 0;

                systems.forEach(system => {
                    const button = frameDoc.querySelector(`[data-system="${system}"]`);
                    if (button) {
                        log(`âœ… ${system.toUpperCase()} button: PRESENT`, 'pass');
                        foundButtons++;
                    } else {
                        log(`âŒ ${system.toUpperCase()} button: MISSING`, 'fail');
                    }
                });

                log(`ğŸ“Š System buttons found: ${foundButtons}/4`, foundButtons === 4 ? 'pass' : 'warn');

                // Test 3: Parameter Controls  
                log('\nğŸ“‹ Test 3: Parameter Controls', 'info');
                const parameters = ['hue', 'speed', 'gridDensity', 'intensity', 'chaos'];
                let foundParams = 0;

                parameters.forEach(param => {
                    const control = frameDoc.getElementById(param);
                    if (control) {
                        log(`âœ… ${param} control: FOUND`, 'pass');
                        foundParams++;
                    } else {
                        log(`âŒ ${param} control: MISSING`, 'fail');
                    }
                });

                log(`ğŸ“Š Parameter controls found: ${foundParams}/${parameters.length}`, foundParams >= 3 ? 'pass' : 'warn');

                // Test 4: Canvas and WebGL
                log('\nğŸ“‹ Test 4: Canvas & WebGL', 'info');
                const canvases = frameDoc.querySelectorAll('canvas');
                let webglContexts = 0;

                canvases.forEach(canvas => {
                    try {
                        if (canvas.getContext('webgl') || canvas.getContext('webgl2')) {
                            webglContexts++;
                        }
                    } catch (e) {
                        // Ignore context creation failures
                    }
                });

                log(`ğŸ“Š Canvas elements: ${canvases.length}`, 'info');
                log(`ğŸ“Š WebGL contexts: ${webglContexts}`, webglContexts > 0 ? 'pass' : 'fail');

                if (webglContexts > 0 && webglContexts < 15) {
                    log('âœ… Context management: OPTIMIZED', 'pass');
                } else if (webglContexts >= 15) {
                    log('âš ï¸ Context management: HIGH USAGE', 'warn');
                } else {
                    log('âŒ Context management: NO CONTEXTS', 'fail');
                }

                // Test 5: Performance Check
                log('\nğŸ“‹ Test 5: Performance Check', 'info');
                
                const performanceAPI = frameWindow.performance;
                if (performanceAPI) {
                    log('âœ… Performance API: AVAILABLE', 'pass');
                    
                    if (performanceAPI.memory) {
                        const memoryUsage = performanceAPI.memory.usedJSHeapSize / 1024 / 1024;
                        log(`ğŸ“Š Memory usage: ${memoryUsage.toFixed(1)} MB`, memoryUsage < 50 ? 'pass' : 'warn');
                    }
                } else {
                    log('âš ï¸ Performance API: LIMITED', 'warn');
                }

                // Test 6: Mobile Responsiveness
                log('\nğŸ“‹ Test 6: Mobile Features', 'info');
                
                const viewportMeta = frameDoc.querySelector('meta[name="viewport"]');
                if (viewportMeta) {
                    log('âœ… Mobile viewport: CONFIGURED', 'pass');
                } else {
                    log('âš ï¸ Mobile viewport: NOT CONFIGURED', 'warn');
                }

                const touchSupport = 'ontouchstart' in frameWindow;
                log(`ğŸ“Š Touch support: ${touchSupport ? 'AVAILABLE' : 'DESKTOP MODE'}`, 'info');

                // Test 7: Modern Standards
                log('\nğŸ“‹ Test 7: 2025 Standards', 'info');
                
                if (frameDoc.querySelector('script[type="module"]')) {
                    log('âœ… ES6 Modules: DETECTED', 'pass');
                } else {
                    log('âš ï¸ ES6 Modules: NOT DETECTED', 'warn');
                }

                if (frameWindow.localStorage) {
                    log('âœ… Local Storage: AVAILABLE', 'pass');
                } else {
                    log('âŒ Local Storage: MISSING', 'fail');
                }

                if (frameWindow.requestAnimationFrame) {
                    log('âœ… Animation API: AVAILABLE', 'pass');
                } else {
                    log('âŒ Animation API: MISSING', 'fail');
                }

                // Run integrated test if available
                setTimeout(() => {
                    if (frameWindow.runVIB34DTests) {
                        log('\nğŸ§ª Running integrated comprehensive tests...', 'info');
                        frameWindow.runVIB34DTests();
                        
                        setTimeout(() => {
                            if (frameWindow.VIB34DTestResults) {
                                const testResults = frameWindow.VIB34DTestResults;
                                generateSummary(testResults);
                            } else {
                                generateBasicSummary();
                            }
                        }, 2000);
                    } else {
                        generateBasicSummary();
                    }
                }, 1000);

            } catch (error) {
                log(`âŒ Testing error: ${error.message}`, 'fail');
                generateBasicSummary();
            }
        }

        function generateSummary(testResults = null) {
            log('\n' + '='.repeat(50), 'info');
            log('ğŸ¯ VIB34D TEST RESULTS SUMMARY', 'info');
            log('='.repeat(50), 'info');

            if (testResults) {
                log(`ğŸ“Š Overall Score: ${testResults.score}%`, testResults.score >= 85 ? 'pass' : 'warn');
                log(`âœ… Tests Passed: ${testResults.passed}`, 'pass');
                log(`âŒ Tests Failed: ${testResults.failed}`, testResults.failed > 0 ? 'fail' : 'pass');
                log(`âš ï¸ Warnings: ${testResults.warnings}`, testResults.warnings > 3 ? 'warn' : 'pass');
                
                let statusClass = testResults.score >= 90 ? 'pass' : testResults.score >= 80 ? 'warn' : 'fail';
                log(`ğŸ¯ Status: ${testResults.status}`, statusClass);
                log(`ğŸš€ Production Ready: ${testResults.productionReady ? 'YES' : 'NO'}`, testResults.productionReady ? 'pass' : 'fail');
                
                // Update results panel
                results.innerHTML = `
                    <h4>ğŸ“Š Test Results (${new Date().toLocaleString()})</h4>
                    <p><strong>Overall Score:</strong> <span class="${statusClass}">${testResults.score}%</span></p>
                    <p><strong>Passed:</strong> <span class="pass">${testResults.passed}</span> | 
                       <strong>Failed:</strong> <span class="fail">${testResults.failed}</span> | 
                       <strong>Warnings:</strong> <span class="warn">${testResults.warnings}</span></p>
                    <p><strong>Status:</strong> <span class="${statusClass}">${testResults.status}</span></p>
                    <p><strong>Production Ready:</strong> <span class="${testResults.productionReady ? 'pass' : 'fail'}">${testResults.productionReady ? 'YES' : 'NO'}</span></p>
                `;
            } else {
                log('ğŸ“‹ Basic validation completed', 'info');
                log('ğŸ” For detailed results, ensure test framework loads correctly', 'warn');
                
                results.innerHTML = `
                    <h4>ğŸ“Š Basic Test Results</h4>
                    <p>Basic validation completed. System appears functional.</p>
                    <p><strong>Note:</strong> For comprehensive results, ensure all components load correctly.</p>
                `;
            }
            
            log('='.repeat(50), 'info');
            log('ğŸ‰ Testing complete!', 'pass');
        }

        function generateBasicSummary() {
            generateSummary(null);
        }

        function runMobileTest() {
            if (!frame.src || frame.src.includes('about:blank')) {
                log('âŒ VIB34D system not loaded. Click "Load VIB34D System" first.', 'fail');
                return;
            }

            log('ğŸ“± Starting mobile-specific tests...', 'info');
            
            // Simulate mobile viewport
            frame.style.width = '390px';
            frame.style.height = '844px';
            
            setTimeout(() => {
                log('ğŸ“± Testing mobile layout...', 'info');
                
                try {
                    const frameDoc = frame.contentDocument;
                    const body = frameDoc.body;
                    
                    if (body.offsetWidth <= 400) {
                        log('âœ… Mobile viewport: RESPONSIVE', 'pass');
                    } else {
                        log('âš ï¸ Mobile viewport: FIXED WIDTH', 'warn');
                    }
                    
                    // Check for mobile-friendly elements
                    const buttons = frameDoc.querySelectorAll('button');
                    let touchFriendlyButtons = 0;
                    
                    buttons.forEach(button => {
                        const rect = button.getBoundingClientRect();
                        if (rect.width >= 40 && rect.height >= 40) {
                            touchFriendlyButtons++;
                        }
                    });
                    
                    log(`ğŸ“Š Touch-friendly buttons: ${touchFriendlyButtons}/${buttons.length}`, 
                        touchFriendlyButtons >= buttons.length * 0.8 ? 'pass' : 'warn');
                    
                    log('ğŸ“± Mobile testing complete', 'pass');
                    
                } catch (error) {
                    log(`âŒ Mobile test error: ${error.message}`, 'fail');
                }
                
                // Reset frame size
                setTimeout(() => {
                    frame.style.width = '100%';
                    frame.style.height = '600px';
                }, 2000);
                
            }, 1000);
        }

        // Initialize
        log('ğŸ” VIB34D Test Runner - 2025 Standards');
        log('ğŸ“‹ Click "Load VIB34D System" to begin testing');
    </script>
</body>
</html>